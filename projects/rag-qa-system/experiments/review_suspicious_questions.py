# Generated by Claude Code
"""Extract suspicious questions for manual review."""
import json
from pathlib import Path

RAGAS_TESTSET_PATH = Path(__file__).parent.parent / "data" / "eval" / "ragas_testset.jsonl"
SUSPICIOUS_INDICES_PATH = Path(__file__).parent.parent / "data" / "eval" / "suspicious_question_indices.json"


def review_questions():
    """Extract and display suspicious questions for manual review."""
    with open(SUSPICIOUS_INDICES_PATH, 'r') as f:
        suspicious_indices = json.load(f)

    with open(RAGAS_TESTSET_PATH, 'r') as f:
        all_questions = [json.loads(line) for line in f]

    print(f"Reviewing {len(suspicious_indices)} suspicious questions\n")
    print("=" * 120)

    for idx in suspicious_indices:
        item = all_questions[idx]

        print(f"\n{'='*120}")
        print(f"[Question {idx}] {item.get('query_style', 'N/A')} / {item.get('query_length', 'N/A')}")
        print(f"{'='*120}")
        print(f"\nQUESTION:\n{item['user_input']}")
        print(f"\nREFERENCE ANSWER:\n{item['reference']}")
        print(f"\nCONTEXTS ({len(item.get('reference_contexts', []))}):")

        for i, ctx in enumerate(item.get('reference_contexts', [])):
            print(f"\n--- Context {i} ({len(ctx)} chars) ---")
            # Print first 500 chars for review
            if len(ctx) > 500:
                print(ctx[:500] + "...")
            else:
                print(ctx)

        print(f"\n{'='*120}")
        input("Press Enter to review next question...")


if __name__ == "__main__":
    review_questions()
